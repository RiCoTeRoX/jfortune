!function(a){function n(a,b){return Math.floor(Math.random()*(b-a+1))+a}function o(a){return"counterclockwise"===a?-1:1}function p(e){var f,h;k||(k=e),f=(e-k)/g.duration,h=Bezier.cubicBezier(g.bezier.p1x,g.bezier.p1y,g.bezier.p2x,g.bezier.p2y,f),c=h*l,j.rotate(c,d),Math.abs(c)<Math.abs(l)?requestAnimationFrame(p):b.resolve(a.isArray(g.prices)?g.prices[i]:i)}function q(){var a=Math.abs(Math.round((.5*e+c)%e)),b=Math.abs(c-h),d=.5*g.separator_thickness,f=e-d;return b>=.5*e?1:d>a||a>f?2:0}function o(a){return"counterclockwise"===a?-1:1}var b,c,d,e,f,g,i,j,k,l,m,h=0;a.fn.fortune=function(r){if(!r||!r.prices)throw new Error("You must define the prices.");return j=this,g=a.extend({},a.fn.fortune.defaults,r),m=a.isArray(r.prices)?g.prices.length:r.prices,e=360/m,this.spin=function(c,f){var j,q,r,s;return b=a.Deferred(),i="number"==typeof c?c:Math.floor(Math.random()*m),d=f||g.direction,s=o(d),q=n(g.separation,e-g.separation),j=e*(("counterclockwise"===d?m-i:i)-.5)+q,r=n(g.min_spins,g.max_spins),l=s*(360*r+j),h=k=0,requestAnimationFrame(p),b.promise()},this.rotate=function(b,e){var i=q();a.fn.fortune.rotate.call(this,c),d=e,direction_multiplier=o(d),c=b,i?(1!==i&&f||g.onSpinBounce(this),a.fn.fortune.spinnerBounce.call(this,direction_multiplier),f=!0):(a.fn.fortune.stopSpinnerBounce.call(this),f=!1),h=c},this},a.fn.fortune.rotate=function(b){a("."+g.wheel_classname,this).css({transform:"rotate("+b+"deg)","-webkit-transform":"rotate("+b+"deg)"})},a.fn.fortune.spinnerBounce=function(b){a("."+g.spinner_classname,this).css({transform:"rotate("+5*b+"deg)","-webkit-transform":"rotate("+5*b+"deg)"})},a.fn.fortune.stopSpinnerBounce=function(){a("."+g.spinner_classname,this).css({transform:"rotate(0)","-webkit-transform":"rotate(0)"})},a.fn.fortune.defaults={duration:1e3,separation:2,min_spins:10,max_spins:15,direction:"clockwise",wheel_classname:"wheel",spinner_classname:"spinner",bezier:{p1x:.17,p1y:.67,p2x:.12,p2y:.99},separator_thickness:3,onSpinBounce:function(){}}}(jQuery);